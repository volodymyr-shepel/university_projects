<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="4/18/2024 12:44:48 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="LAPTOP-L4MV6S80"
  DTS:CreatorName="LAPTOP-L4MV6S80\vshep"
  DTS:DTSID="{CFE33123-D786-41AA-892F-8703A7585DFE}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="16.0.5397.1"
  DTS:LocaleID="1033"
  DTS:ObjectName="Package"
  DTS:PackageType="5"
  DTS:VersionBuild="22"
  DTS:VersionGUID="{C53FBFB2-29E9-4DE0-BD04-EACDEE4A1AD3}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[LAPTOP-L4MV6S80.AdventureWorks2022]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{986376E9-56BF-4424-9185-9D0339D04651}"
      DTS:ObjectName="LAPTOP-L4MV6S80.AdventureWorks2022">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectRetryCount="1"
          DTS:ConnectRetryInterval="5"
          DTS:ConnectionString="Data Source=LAPTOP-L4MV6S80;Initial Catalog=AdventureWorks2022;Provider=SQLOLEDB.1;Integrated Security=SSPI;Application Name=SSIS-Package-{986376E9-56BF-4424-9185-9D0339D04651}LAPTOP-L4MV6S80.AdventureWorks2022;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:DTSID="{FC2372B1-29CF-4221-8BD0-3BF39679EC12}"
      DTS:ObjectName="SMTPConnectionManager_ConnectionString">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">SmtpServer=smtp.gmail.com;UseWindowsAuthentication=False;EnableSsl=True;user=v.shepel158@gmail.com;password=MegaRush!15082003</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Add integrity constraint DIM_TIME"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{4278AB31-561E-48F0-A706-6069C2A3C3A2}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Add integrity constraint DIM_TIME"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{986376E9-56BF-4424-9185-9D0339D04651}"
          SQLTask:SqlStatementSource="ALTER TABLE Shepel_Molenda.FACT_SALES&#xA;ADD CONSTRAINT FK_OrderDate&#xA;FOREIGN KEY (OrderDate)&#xA;REFERENCES Shepel_Molenda.DIM_TIME(PK_TIME);&#xA;&#xA;ALTER TABLE Shepel_Molenda.FACT_SALES&#xA;ADD CONSTRAINT FK_ShipDate&#xA;FOREIGN KEY (ShipDate)&#xA;REFERENCES Shepel_Molenda.DIM_TIME(PK_TIME);" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Add integrity constraints"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{E2A752F4-541B-4440-B190-077A71BA09EA}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Add integrity constraints"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{986376E9-56BF-4424-9185-9D0339D04651}"
          SQLTask:SqlStatementSource="-- Define referential constraints for FACT_SALES table&#xA;ALTER TABLE Shepel_Molenda.FACT_SALES&#xA;ADD CONSTRAINT FK_ProductID&#xA;    FOREIGN KEY (ProductID)&#xA;    REFERENCES Shepel_Molenda.DIM_PRODUCT (ProductID);&#xA;&#xA;ALTER TABLE Shepel_Molenda.FACT_SALES&#xA;ADD CONSTRAINT FK_CustomerID&#xA;    FOREIGN KEY (CustomerID)&#xA;    REFERENCES Shepel_Molenda.DIM_CUSTOMER (CustomerID);&#xA;&#xA;ALTER TABLE Shepel_Molenda.FACT_SALES&#xA;ADD CONSTRAINT FK_SalesPersonID&#xA;    FOREIGN KEY (SalesPersonID)&#xA;    REFERENCES Shepel_Molenda.DIM_SALESPERSON (SalesPersonID);" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\CREATE AND FILL DIM_TIME"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="CREATE AND FILL DIM_TIME"
      DTS:DTSID="{FEEA41E6-3E3A-417A-BB0E-CE8D87AE5063}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="CREATE AND FILL DIM_TIME"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{986376E9-56BF-4424-9185-9D0339D04651}"
          SQLTask:SqlStatementSource="CREATE TABLE Shepel_Molenda.DIM_TIME (&#xA;    PK_TIME INT PRIMARY KEY,&#xA;    Year INT,&#xA;    Month VARCHAR(20),&#xA;    Weekday VARCHAR(20),&#xA;    DayOfMonth INT&#xA;);&#xA;&#xA;INSERT INTO Shepel_Molenda.DIM_TIME (PK_TIME, Year, Month, Weekday, DayOfMonth)&#xA;&#xA;SELECT DISTINCT PK_TIME, Year, MonthNumber, WeekdayNumber, DayOfMonth FROM (&#xA;    SELECT &#xA;        FS.OrderDate AS PK_TIME,&#xA;        CAST(LEFT(CONVERT(VARCHAR, FS.OrderDate), 4) AS INT) AS Year,&#xA;        HM.MonthNumber AS MonthNumber,&#xA;        HW.WeekdayNumber AS WeekdayNumber,&#xA;        CAST(RIGHT(LEFT(CONVERT(VARCHAR, FS.OrderDate), 6), 2) AS INT) AS DayOfMonth&#xA;    FROM &#xA;        Shepel_Molenda.FACT_SALES AS FS&#xA;    JOIN &#xA;        Shepel_Molenda.Helper_Month HM &#xA;        ON CONVERT(INT, RIGHT(LEFT(CONVERT(VARCHAR, FS.OrderDate), 6), 2)) = HM.MonthNumber&#xA;    JOIN &#xA;        Shepel_Molenda.Helper_Weekday HW&#xA;        ON DATEPART(WEEKDAY, CONVERT(DATETIME, CONVERT(VARCHAR, FS.OrderDate), 112)) = HW.WeekdayNumber&#xA;&#xA;    UNION&#xA;&#xA;    SELECT &#xA;        ShipDate AS PK_TIME,&#xA;        CAST(LEFT(CONVERT(VARCHAR, FS.ShipDate), 4) AS INT) AS Year,&#xA;        HM.MonthNumber AS MonthNumber,&#xA;        HW.WeekdayNumber AS WeekdayNumber,&#xA;        CAST(RIGHT(LEFT(CONVERT(VARCHAR, FS.ShipDate), 6), 2) AS INT) AS DayOfMonth&#xA;    FROM &#xA;        Shepel_Molenda.FACT_SALES AS FS&#xA;    JOIN &#xA;        Shepel_Molenda.Helper_Month HM &#xA;        ON CONVERT(INT, RIGHT(LEFT(CONVERT(VARCHAR, FS.ShipDate), 6), 2)) = HM.MonthNumber&#xA;    JOIN &#xA;        Shepel_Molenda.Helper_Weekday HW&#xA;        ON DATEPART(WEEKDAY, CONVERT(DATETIME, CONVERT(VARCHAR, FS.ShipDate), 112)) = HW.WeekdayNumber&#xA;) AS T;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Create helper tables"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Helper month,Helper weekday"
      DTS:DTSID="{6E953387-5A6B-47AF-968A-76654FF56B4F}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Create helper tables"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{986376E9-56BF-4424-9185-9D0339D04651}"
          SQLTask:SqlStatementSource="CREATE TABLE  Shepel_Molenda.Helper_Month (&#xA;    MonthNumber INT,&#xA;    MonthName VARCHAR(20)&#xA;);&#xA;&#xA;-- Populate the helper table with month names&#xA;INSERT INTO Shepel_Molenda.Helper_Month (MonthNumber, MonthName)&#xA;VALUES&#xA;    (1, 'January'),&#xA;    (2, 'February'),&#xA;    (3, 'March'),&#xA;    (4, 'April'),&#xA;    (5, 'May'),&#xA;    (6, 'June'),&#xA;    (7, 'July'),&#xA;    (8, 'August'),&#xA;    (9, 'September'),&#xA;    (10, 'October'),&#xA;    (11, 'November'),&#xA;    (12, 'December');&#xA;&#xA;CREATE TABLE  Shepel_Molenda.Helper_Weekday (&#xA;    WeekdayNumber INT,&#xA;    WeekdayName VARCHAR(20)&#xA;);&#xA;&#xA;INSERT INTO Shepel_Molenda.Helper_Weekday (WeekdayNumber, WeekdayName)&#xA;VALUES&#xA;    (1, 'Sunday'),&#xA;    (2, 'Monday'),&#xA;    (3, 'Tuesday'),&#xA;    (4, 'Wednesday'),&#xA;    (5, 'Thursday'),&#xA;    (6, 'Friday'),&#xA;    (7, 'Saturday');" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Create Tables"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{6CE6472E-85EC-49C5-A5DD-B289C4BD09F4}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Create Tables"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{986376E9-56BF-4424-9185-9D0339D04651}"
          SQLTask:SqlStatementSource="CREATE TABLE Shepel_Molenda.DIM_CUSTOMER (&#xA;    CustomerID INT PRIMARY KEY,&#xA;    FirstName NVARCHAR(50),&#xA;    LastName NVARCHAR(50),&#xA;    TerritoryName NVARCHAR(50),&#xA;    CountryRegionCode NVARCHAR(3),&#xA;    GroupName NVARCHAR(50)&#xA;);&#xA;&#xA;CREATE TABLE Shepel_Molenda.DIM_PRODUCT (&#xA;    ProductID INT PRIMARY KEY,&#xA;    Name NVARCHAR(50),&#xA;    ListPrice MONEY,&#xA;    Color NVARCHAR(15),&#xA;    SubCategoryName NVARCHAR(50),&#xA;    CategoryName NVARCHAR(50)&#xA;);&#xA;&#xA;CREATE TABLE Shepel_Molenda.DIM_SALESPERSON (&#xA;    SalesPersonID INT PRIMARY KEY,&#xA;    FirstName NVARCHAR(50),&#xA;    LastName NVARCHAR(50),&#xA;    Title NVARCHAR(8), -- A courtesy title. For example, Mr. or Ms.&#xA;    Gender NCHAR(1),&#xA;    CountryRegionCode NVARCHAR(3),&#xA;    GroupName NVARCHAR(50), -- Name of the group to which the department belongs&#xA;    Age INT&#xA;);&#xA;&#xA;-- Added SalesOrderDetailID to uniquely identify record &#xA;CREATE TABLE Shepel_Molenda.FACT_SALES (&#xA;    SalesOrderDetailID INT PRIMARY KEY,&#xA;&#x9;ProductID INT,&#xA;    CustomerID INT,&#xA;    SalesPersonID INT,&#xA;    OrderDate INT,&#xA;    ShipDate INT,&#xA;    OrderQty SMALLINT,&#xA;    UnitPrice MONEY,&#xA;    UnitPriceDiscount MONEY,&#xA;    LineTotal NUMERIC(38, 6)&#xA;);&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\DROP TABLES IN SCHEMA"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{5F52AD18-FA4C-411B-88CA-AA2CAB410E8C}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="DROP TABLES IN SCHEMA"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{986376E9-56BF-4424-9185-9D0339D04651}"
          SQLTask:SqlStatementSource="IF EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'Shepel_Molenda' AND TABLE_NAME = 'FACT_SALES')&#xA;    DROP TABLE Shepel_Molenda.FACT_SALES;&#xA;&#xA;IF EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'Shepel_Molenda' AND TABLE_NAME = 'DIM_SALESPERSON')&#xA;    DROP TABLE Shepel_Molenda.DIM_SALESPERSON;&#xA;&#xA;IF EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'Shepel_Molenda' AND TABLE_NAME = 'DIM_PRODUCT')&#xA;    DROP TABLE Shepel_Molenda.DIM_PRODUCT;&#xA;&#xA;IF EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'Shepel_Molenda' AND TABLE_NAME = 'DIM_CUSTOMER')&#xA;    DROP TABLE Shepel_Molenda.DIM_CUSTOMER;&#xA;&#xA;-- Added tables defined defined in task 7&#xA;IF EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'Shepel_Molenda' AND TABLE_NAME = 'Helper_Month')&#xA;    DROP TABLE Shepel_Molenda.Helper_Month;&#xA;&#xA;IF EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'Shepel_Molenda' AND TABLE_NAME = 'Helper_Weekday')&#xA;    DROP TABLE Shepel_Molenda.Helper_Weekday;&#xA;&#xA;IF EXISTS (SELECT 1 FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = 'Shepel_Molenda' AND TABLE_NAME = 'DIM_TIME')&#xA;    DROP TABLE Shepel_Molenda.DIM_TIME;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Handle Null values in DIM_PRODUCT"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{F13698D4-0217-4477-A5F7-8BD9E4E2ADA2}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Handle Null values in DIM_PRODUCT"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{986376E9-56BF-4424-9185-9D0339D04651}"
          SQLTask:SqlStatementSource="-- Update Color column&#xA;UPDATE Shepel_Molenda.DIM_PRODUCT&#xA;SET Color = 'Unknown'&#xA;WHERE Color IS NULL;&#xA;&#xA;-- Update SubCategoryName column&#xA;UPDATE Shepel_Molenda.DIM_PRODUCT&#xA;SET SubCategoryName = 'Unknown'&#xA;WHERE SubCategoryName IS NULL;&#xA;&#xA;UPDATE Shepel_Molenda.DIM_PRODUCT&#xA;SET CategoryName = 'Unknown'&#xA;WHERE CategoryName IS NULL;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Handle null values in DIM_SALESPERSON"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{F6EBFE69-6EA3-4663-AF48-411C33AE9D00}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Handle null values in DIM_SALESPERSON"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{986376E9-56BF-4424-9185-9D0339D04651}"
          SQLTask:SqlStatementSource="UPDATE Shepel_Molenda.DIM_SALESPERSON&#xA;SET CountryRegionCode = '000'&#xA;WHERE CountryRegionCode IS NULL;&#xA;&#xA;-- Update GroupName column&#xA;UPDATE Shepel_Molenda.DIM_SALESPERSON&#xA;SET GroupName = 'Unknown'&#xA;WHERE GroupName IS NULL;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Insert data into tables"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{489014B4-76F7-4F06-9C3F-1403D497A1DF}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Insert data into tables"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{986376E9-56BF-4424-9185-9D0339D04651}"
          SQLTask:SqlStatementSource="INSERT INTO Shepel_Molenda.DIM_CUSTOMER (&#xA;&#x9;CustomerID, &#xA;&#x9;FirstName,&#xA;&#x9;LastName,&#xA;&#x9;TerritoryName,&#xA;&#x9;CountryRegionCode,&#xA;&#x9;GroupName)&#xA;SELECT &#xA;    SC.CustomerID AS CustomerID,&#xA;    PP.FirstName AS FirstName,&#xA;    PP.LastName AS LastName,&#xA;    SST.Name AS TerritoryName,&#xA;    SST.CountryRegionCode AS CountryRegionCode,&#xA;    SST.&quot;Group&quot; AS GroupName&#xA;FROM Sales.Customer AS SC&#xA;LEFT JOIN Person.Person AS PP ON SC.PersonID = PP.BusinessEntityID&#xA;LEFT JOIN Sales.SalesTerritory AS SST ON SC.TerritoryID = SST.TerritoryID;&#xA;&#xA;&#xA;-- INSERT INTO DIM_PRODUCT&#xA;INSERT INTO Shepel_Molenda.DIM_PRODUCT (&#xA;    ProductID,&#xA;    Name,&#xA;    ListPrice,&#xA;    Color,&#xA;    SubCategoryName,&#xA;    CategoryName&#xA;)&#xA;SELECT &#xA;    PP.ProductID AS ProductID,&#xA;    PP.Name AS Name,&#xA;    PP.ListPrice AS ListPrice,&#xA;    PP.Color AS Color,&#xA;    PPS.Name AS SubCategoryName,&#xA;    PPC.Name AS CategoryName&#xA;FROM Production.Product AS PP&#xA;LEFT JOIN Production.ProductSubcategory AS PPS ON PP.ProductSubcategoryID = PPS.ProductSubcategoryID&#xA;LEFT JOIN Production.ProductCategory AS PPC ON PPS.ProductCategoryID = PPC.ProductCategoryID;&#xA;&#xA;-- INSERT INTO DIM_SALESPERSON&#xA;INSERT INTO Shepel_Molenda.DIM_SALESPERSON (SalesPersonID, FirstName, LastName, Title, Gender, CountryRegionCode, GroupName, Age)&#xA;SELECT &#xA;&#x9;SSP.BusinessEntityID AS SalesPersonID,&#xA;&#x9;PP.FirstName AS FirstName,&#xA;&#x9;PP.LastName AS LastName,&#xA;&#x9;PP.Title AS Title,&#xA;&#x9;HRE.Gender AS Gender,&#xA;&#x9;SST.CountryRegionCode AS CountryRegionCode,&#xA;&#x9;SST.&quot;Group&quot; AS GroupName,&#xA;&#x9;CASE &#xA;        WHEN MONTH(GETDATE()) &gt; MONTH(HRE.BirthDate) OR MONTH(GETDATE()) = MONTH(HRE.BirthDate) AND DAY(GETDATE()) &gt;= DAY(HRE.BirthDate) THEN DATEDIFF(year, HRE.BirthDate, GETDATE()) &#xA;        ELSE DATEDIFF(year, HRE.BirthDate, GETDATE()) - 1 &#xA;    END AS Age&#xA;&#x9;&#xA;FROM Sales.SalesPerson AS SSP&#xA;LEFT JOIN Person.Person AS PP&#xA;ON SSP.BusinessEntityID = PP.BusinessEntityID&#xA;LEFT JOIN HumanResources.Employee AS HRE&#xA;ON SSP.BusinessEntityID = HRE.BusinessEntityID&#xA;LEFT JOIN Sales.SalesTerritory AS SST&#xA;ON SSP.TerritoryID = SST.TerritoryID&#xA;&#xA;&#xA;-- INSERT INTO FACT_SALES&#xA;-- STILL NEED TO VERIFY FOR SalesPersonID&#xA;INSERT INTO Shepel_Molenda.FACT_SALES (&#xA;    SalesOrderDetailID,&#xA;    ProductID,&#xA;    CustomerID,&#xA;    SalesPersonID,&#xA;    OrderDate,&#xA;    ShipDate,&#xA;    OrderQty,&#xA;    UnitPrice,&#xA;    UnitPriceDiscount,&#xA;    LineTotal&#xA;)&#xA;SELECT&#xA;    SOD.SalesOrderDetailID,&#xA;    SOD.ProductID,&#xA;    SOH.CustomerID,&#xA;    SOH.SalesPersonID,&#xA;    CONVERT(INT, CONVERT(VARCHAR(4), YEAR(SOH.OrderDate)) +&#xA;                RIGHT('00' + CONVERT(VARCHAR(2), MONTH(SOH.OrderDate)), 2) +&#xA;                RIGHT('00' + CONVERT(VARCHAR(2), DAY(SOH.OrderDate)), 2)) AS EncodedOrderDate,&#xA;    CONVERT(INT, CONVERT(VARCHAR(4), YEAR(SOH.ShipDate)) +&#xA;                RIGHT('00' + CONVERT(VARCHAR(2), MONTH(SOH.ShipDate)), 2) +&#xA;                RIGHT('00' + CONVERT(VARCHAR(2), DAY(SOH.ShipDate)), 2)) AS EncodedShipDate,&#xA;    SOD.OrderQty,&#xA;    SOD.UnitPrice,&#xA;    SOD.UnitPriceDiscount,&#xA;    SOD.LineTotal&#xA;FROM &#xA;    Sales.SalesOrderHeader AS SOH&#xA;INNER JOIN &#xA;    Sales.SalesOrderDetail AS SOD ON SOH.SalesOrderID = SOD.SalesOrderID;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{A6797F20-DE80-4B10-BD84-562345C1F8E6}"
      DTS:From="Package\DROP TABLES IN SCHEMA"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Create Tables" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{925E908D-E509-4777-B2A2-DE6BAB4C5691}"
      DTS:From="Package\Create Tables"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Insert data into tables" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{6E20229F-9E45-497D-9AA3-241985011289}"
      DTS:From="Package\Insert data into tables"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\Add integrity constraints" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{E119704F-DE0E-4164-BB7E-3DBB13DB2901}"
      DTS:From="Package\Add integrity constraints"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\Create helper tables" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{8575CF2F-9A99-4A70-895D-ACC96E674279}"
      DTS:From="Package\Create helper tables"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\CREATE AND FILL DIM_TIME" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 5]"
      DTS:CreationName=""
      DTS:DTSID="{4DFEDEB6-E4FB-4B67-A576-AB1B85A42BE5}"
      DTS:From="Package\CREATE AND FILL DIM_TIME"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 5"
      DTS:To="Package\Add integrity constraint DIM_TIME" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 6]"
      DTS:CreationName=""
      DTS:DTSID="{0F40A161-F1F2-44DA-990C-5527AB1D7899}"
      DTS:From="Package\Add integrity constraint DIM_TIME"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 6"
      DTS:To="Package\Handle Null values in DIM_PRODUCT" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 7]"
      DTS:CreationName=""
      DTS:DTSID="{E6A5716B-C0F1-430C-9F9D-8A2DAF872FEA}"
      DTS:From="Package\Handle Null values in DIM_PRODUCT"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 7"
      DTS:To="Package\Handle null values in DIM_SALESPERSON" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="32" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="164.8,41.6"
          Id="Package\Add integrity constraints"
          TopLeft="299.547602981566,291.499998011192" />
        <NodeLayout
          Size="164.8,41.6"
          Id="Package\Create Tables"
          TopLeft="289.759243728019,132.611110227196" />
        <NodeLayout
          Size="211.2,41.6"
          Id="Package\DROP TABLES IN SCHEMA"
          TopLeft="269.44442972265,26.9629627754658" />
        <NodeLayout
          Size="164.8,41.6"
          Id="Package\Insert data into tables"
          TopLeft="303.092577971979,211.722220996795" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="373.601836725334,68.5629627754658">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,64.0481474517305"
              Start="0,0"
              End="0,56.5481474517305">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,56.5481474517305" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="385.307391977348,174.211110227196">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,37.5111107695985"
              Start="0,0"
              End="0,30.0111107695985">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,30.0111107695985" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="383.720090476772,253.322220996795">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,38.1777770143969"
              Start="0,0"
              End="0,30.6777770143969">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,30.6777770143969" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="172,41.6"
          Id="Package\Create helper tables"
          TopLeft="295.083317511198,371.666664120389" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="381.515460246382,333.099998011192">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,38.5666661091974"
              Start="0,0"
              End="0,31.0666661091974">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31.0666661091974" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="221.6,41.6"
          Id="Package\CREATE AND FILL DIM_TIME"
          TopLeft="275.499985247851,459.899996944467" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="383.691651379525,413.266664120389">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,46.6333328240779"
              Start="0,0"
              End="0,39.1333328240779">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,39.1333328240779" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="236.8,41.6"
          Id="Package\Add integrity constraint DIM_TIME"
          TopLeft="273.833318672247,547.252598733339" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 5]"
          TopLeft="389.266651960049,501.499996944467">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,45.752601788872"
              Start="0,0"
              End="0,38.252601788872">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,38.252601788872" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="164.8,41.6"
          Id="Package\Handle Null values in DIM_PRODUCT"
          TopLeft="309.666650047733,624.916663012985" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 6]"
          TopLeft="392.14998435999,588.852598733339">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,36.0640642796454"
              Start="0,0"
              End="0,28.5640642796454">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,28.5640642796454" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <NodeLayout
          Size="164.8,41.6"
          Id="Package\Handle null values in DIM_SALESPERSON"
          TopLeft="312.791649876991,713.783331427392" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 7]"
          TopLeft="393.629149962362,666.516663012985">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,47.2666684144073"
              Start="0,0"
              End="0,39.7666684144073">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,39.7666684144073" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>